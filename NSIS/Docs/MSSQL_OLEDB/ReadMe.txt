MSSQL OLEDB PLUGIN
---------------------

Written by Stefano Giusto <sgiusto@mmpoint.it>

The MSSQL OLEDB plugin for NSIS provides some functions to add
MSSQL interoperability within an install script

COMPATIBILITY
-------------

Windows NT,2000,XP,Vista,2003,2008


MODIFICATIONS
-------------

-  12 March 2007 - First release
-  20 March 2007 - Fixed a bug in DllMain under windows 2000
-  29 March 2007 - Added SQL_ExecuteScript function
-  24 May   2007 - Fixed a bug in Data Column Binding causing data truncation in rowsets
-  11 Sept  2007 - added support for Unicode SQL scripts in SQL_ExecuteScript function
-  11 April 2009 - added support for new plugin api
                   added unicode version (Unicode scripts support is available only in unicode version from now on)
                   script length is limited only by memory
-  01 Aug   2009 - Fixed an allocation bug. Global variables were not set to null after deletion in SQL_Logout function



NOTES
-----

MSSQL_OLEDB.dll is the standard (non Unicode) version of the plugin
UMSSQL_OLEDB.dll is the Unicode version of the plugin
To execute Unicode scripts the unicode version of NSIS and the unicode version of the plugin MUST be used.



FUNCTIONS
---------

SQL_Logon <server> <user> <password>

	Logs on a SQL Server
	<server>        Network name of SQL Server to log on
	<user>          User (leave blank to use windows authentication)
	<password>      Password

    Returns:    "0" Success, "1" Failure
                A Message string
                
SQL_Execute <query>

    Excecutes a SQL query
    <query> SQL query to execute
    
    Returns:    "0" Success, "1" Failure
                A message string
                
SQL_ExecuteScript <scriptfile>

    Excecutes a SQL query contained in a file
    <scriptfile> Path to file containing the script to execute (max 60000 bytes)
                 Note: The scriptfile can be in Ansi or Unicode format
    
    Returns:    "0" Success, "1" Failure
                A message string

SQL_GetRow

    Retrieves a row of data from the SQL server
    
    Returns:    "0" Success, "1" Failure, "2" No more data to read
                A string containing the row of data (each column is separated
                by a '|' char). A message in case if error or no more data
                
SQL_GetError

    Retrieves last error message generated by SQL Server
    Call this function after a failure to get SQL state, native error code and message

    Returns:    "0" Success
                A string containing the error
                
SQL_Logout

    Deallocates memory used by dll and logs out of SQL server
