描述
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
该插件与控制台应用程序一起使用，创建具有重定向输入/输出的隐藏子进程。与 NSISdl 相比，它具有 4 个附加组件：
---------------------------------------------------------------------------------------------
1）字符串参数作为正在运行的应用程序的标准输入；
2）同步/异步进程启动选项；
3）也可以在“Section”之外工作；
4）多线程。
---------------------------------------------------------------------------------------------------
+ 第一个可以在您想要为运行的应用程序提供登录/密码时很有用，
+ 第二个可以用于长时间运行的应用程序，
+ 第三个可以用于 .onInit 函数检查，
+ 第四个可以同时运行几个 DOS 应用程序。插件可以将应用程序输出放入日志文件、“详细”安装程序窗口、任何其他文本窗口、安装程序堆栈或调用脚本函数来处理每一行。在特殊的 NSIS 构建中，最大输入字符串大小为 8kB，在其他情况下为 1 kB。
===========================================================
使用方法
==============================================================
ExecDos::exec [/ASYNC] [/TIMEOUT=xxx] [/TOSTACK | /DETAILED | /TOWINDOW | /TOFUNC] [/ENDFUNC=func] [/DISABLEFSR] application_to_run [stdin_string] [log_file_name | window | function]

/ASYNC - 不等待进程退出。使用“wait”获取退出代码
/TIMEOUT - 执行总时间，毫秒，例如 /TIMEOUT=10000。默认足够大。较短的超时可能导致应用程序被终止。
/TOSTACK - 将非空输出行放入堆栈中（不从堆栈中读取 log_file_name 参数）
/DETAILED - 将输出行放入安装程序的详细窗口中
/TOWINDOW - 将输出行添加到目标窗口。支持编辑、RichEdit、ListView 和 ListBox。
/TOFUNC - 将输出行推送到安装程序堆栈并调用脚本函数
/DISABLEFSR - 在 x64 机器上禁用 ExecDos 内部线程的 WOW64 文件系统重定向
application_to_run - 要运行的应用程序（必填）
stdin_string - 应用程序可以从标准输入中获取的所有内容（可选）
log_file_name - 存放应用程序 stdout 的文件（可选），或目标窗口句柄，或脚本函数指针

请注意 - 如果安装程序堆栈不为空，则最后两个参数是可选的。在不使用参数的情况下，更安全的做法是使用 ""。如果在安装期间出现随机文件，则是因为这个原因（即 log_file_name）。

  ExecDos::wait HANDLE
HANDLE - 仅用于异步模式，等待的线程句柄。返回应用程序的退出代码或错误代码。

ExecDos::isdone HANDLE
HANDLE - 仅用于异步模式，检查线程是否在运行。返回1表示应用程序已退出，返回0表示仍在运行，返回-1表示出错。

异步启动的示例：

ExecDos::exec /ASYNC "$EXEDIR\consApp.exe" "test_login$\ntest_pwd$\n" "$EXEDIR\execdos.log"
Pop $0 ; 获取'wait'的线程句柄。
ExecDos::wait $0
Pop $0 ; 退出代码
MessageBox MB_OK "退出代码 $0"

同步启动：

ExecDos::exec "$EXEDIR\consApp.exe" "" ""
Pop $0 ; 退出代码
MessageBox MB_OK "退出代码 $0"

BAT 文件的特殊情况：

在某些Win98系统中，DOS应用程序的"退出时关闭"选项未设置。因此，在批处理执行完成后（而安装程序继续其工作时），隐藏的窗口仍然保留在系统中，称为"winoldapp"。以下两行代码解决了这个问题：

@echo off

在此处放置您的批处理代码
cls
=======================================================================================================
Telnet 和 ssh - 插件不适用于需要终端仿真的应用程序。
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Takhir Bedertdinov，INEUM，俄罗斯莫斯科
Stuart 'Afrow UK' Welch，英国，afrowuk@afrowsoft.co.uk
文档翻译：水晶石

