EmbeddedLists.dll v1.4 RC2 由 Afrow UK 提供

一个用于从 INI 文件中显示列表视图和树视图控件的 NSIS 插件。

最后构建日期：2010年7月8日

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

将 Plugins\EmbeddedLists.dll 复制到 NSIS\Plugins 文件夹，或将 Unicode\Plugins\EmbeddedLists.dll 复制到 NSIS\Unicode\Plugins 文件夹，然后从 Zip 文件中提取所有文件到 NSIS 文件夹。

在 Examples\EmbeddedLists 中查看使用示例。
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 显示对话框
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

  EmbeddedLists::Dialog "el_file.ini"
   Pop $Var

   "el_file.ini"：EmbeddedLists INI 文件的路径。

  这是调用插件的常规方式。

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  EmbeddedLists::InitDialog "el_file.ini"
   Pop $HWNDVar
  EmbeddedLists::Show
   Pop $Var

   "el_file.ini"：EmbeddedLists INI 文件的路径。

  通过在 InitDialog 和 Show 调用之间以及页面的 Leave 函数中使用 $HWNDVar，此方法允许您使用 SendMessage、SetCtlColors 等修改对话框上的控件。

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  此时，$Var 将包含以下内容：
  - 在显示错误时为 "ERROR"，
  - 如果按下下一步按钮为 "NEXT"，
  - 如果按下返回按钮为 "BACK"，
  - 如果按下取消按钮为 "CANCEL"。

  在页面的离开函数中，进一步使用 Pop 来访问已选或已检查的项目。要标记列表结束，栈上将包含 "/END"。


~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INI 文件区段 [Settings]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

[Settings] 区段包含了插件的初始化属性。
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
  这些属性适用于插件的所有对话框...

 Type=ListView|TreeView - 对话框类型。
HeadingText=(text) - 在标题标签中显示的文本。
GroupText=(text) - 在分组框中显示的文本。
Caption=(text) - 在安装程序标题中显示的文本。
ReturnItemText=0|1 - 在页面离开时返回所选/选中项目的文本。否则，默认返回项目编号（自 v0.9 起添加）。
LabelEdit=0|1 - 启用项目标签编辑。
CheckBoxes=0|1 - 项目具有复选框。
ToggleNextButton=0|1 - 直到选中或选择了项目，下一步按钮才保持禁用。
NoItemSelection=0|1 - 无法选择项目。
Rect=(rect_id) - 用于显示对话框的黑色矩形。默认为 1018。
ViewListOnly=0|1 - 列表控件被拉伸以适应整个窗口。标题标签和分组框被销毁。
UseCheckBitmap=0|1|path - 使用 NSIS 组件页的复选框状态图像的复选框位图。这使得 EmbeddedLists 可以支持与组件页相同的复选框状态（自 v1.0 起添加）。如果您的安装程序中未使用组件页，请指定完整的文件路径。此设置默认启用。
这些属性仅适用于 ListView 对话框...

ColumnHeader=0|1 - 列表具有列标题。
SingleSelect=0|1 - 同一时间只能选择一个列表项。
Sort=none|ascending|descending - 对列表视图项目进行排序。
SortByColumn=# - 初始列，按其对项目进行排序，其中 # 是从 1 开始的整数值。
SortByColumnClick=0|1 - 列标题可点击。允许按各列对项目进行排序。
这些属性仅适用于 TreeView 对话框。

ParentCheck=0|1 - 检查或取消检查父节点的复选框会检查或取消检查所有子节点。如果所有子节点已检查或未检查，则还会检查或取消检查父节点（自 v0.9 起添加）。
[Icons] 区段定义了用于 ListView 和 TreeView 项目旁边的图标（.ico）文件列表。

IconCount=# - 列表中的图标数。使用并非强制性但明智。
Icon#=(file path) - 指定图标文件的完整路径。# 是从 1 开始的整数值。
示例：

  示例：

  [Icons]
IconCount=3
Icon1=x:\path\to\icon1.ico
Icon2=x:\path\to\icon2.ico
Icon3=x:\path\to\icon3.ico


  注意：要在运行时设置图标路径，请在显示对话框之前使用 WriteINIStr 指令。

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[Columns] 区段设置 ListView 列标题...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 Column#=(text) - 创建列并设置其标题文本。# 是从 1 开始的整数值。
 Column#Width=(width) - 以单位设置列宽。宽度值必须是整数值。# 是从 1 开始的整数值。


  示例:

  [Columns]
  Column1=My column 1!
  Column1Width=250
  Column2=Column 2!
  Column2Width=100

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 INI 文件区段 [Item #]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 "[Item #] 区段" 创建了一个 ListView 或 TreeView 项目。

是从 1 开始的整数值，每个项目递增 1。

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
 这些属性适用于插件的所有对话框...

Text=(text) - 项目的文本。
IconIndex=# - 放置在项目左侧的图标的索引，从 1 开始计数。图标在此文档前面的 [Icon] 区段中创建。
Checked=0|1 - 设置项目复选框的选中状态。
DisableCheck=0|1|2 - 复选框状态不能更改，保持与 INI 文件中设置的相同。如果是 2，则在使用复选框位图时，复选框将被隐藏。
DisableLabelEdit=0|1 - 无法编辑此项目标签。在 [Settings] 下使用 LabelEdit=1 时很有用。

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
 
这些属性仅适用于 ListView 对话框...

SubItem#=(text) - 在列 # 下设置的项目文本。# 是从 1 开始的整数值，其中 1 是第一列。
Selected=0|1 - 设置项目的选择状态。

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
 
这些属性仅适用于 TreeView 对话框...
我们也将项目称为 '节点'。

Position=# - 设置节点及其后续节点的缩进。用于创建父节点和子节点，其中子节点出现在父节点内。
Expanded=0|1 - 如果节点是具有其他子节点的父节点，则设置展开状态。
BoldText=0|1 - 节点的文本为粗体

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
EmbeddedLists 插件版本历史
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

  v1.4 - 2010年7月8日

移除 DLL 清单以解决对 Microsoft VC90 CRT 的依赖性。
现在在非 Unicode 构建中使用 ANSI pluginapi.lib。
RC2：添加版本信息资源。
v1.3 - 2010年3月30日

进行了轻微的代码清理。
将示例脚本更改为 MUI2。
添加了 Unicode 构建。
v1.2 - 2007年7月14日

在列表视图中添加了 LVS_EX_LABELTIP 扩展样式。
v1.1 - 2007年6月25日

添加了 DisableCheck=2 以在使用复选框位图时隐藏复选框。
修复了 ParentCheck=1 的问题。
v1.0 - 2007年6月2日

添加了右键菜单，提供选择和检查项目/节点的选项。
添加了对 NSIS 组件页检查位图的支持，允许禁用和部分选中的图像。
在不使用检查位图时修复了许多复选框的问题。
清理并利用了大量代码。
v0.9 - 2007年5月31日

如果所有子节点已检查/未检查，现在父树节点将被检查/取消检查。
选择/选中项目的默认返回值现在是项目编号，而不是项目文本。在设置 INI 文件区段中使用 ReturnItemText 会使用旧样式。
v0.8 - 2006年7月22日

现在正确显示32位图标。
v0.7 - 2006年7月11日

对自定义 UI 大小提供了更好的支持。
字体现在来自父窗口而不是系统。
v0.6 - 2006年6月9日

添加了 Rect INI 文件设置。
添加了 ViewListOnly INI 文件设置。
v0.5 - 2006年5月25日

修复了返回选定和选中项目的问题。
Selected=# 现在正常工作。
现在为 TreeView 保存了标签编辑。
v0.4 - 2006年5月24日

进行了重大更改。
插件现在使用 INI 文件。
v0.3

修复了崩溃问题。
v0.2

在 VC++6 下重新编译，试图解决崩溃问题。
v0.1

首次构建。

文档翻译：水晶石